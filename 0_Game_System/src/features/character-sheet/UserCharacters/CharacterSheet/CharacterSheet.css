/*
    Created on : 04/11/2023
    Author     : Steven
*/

:root{
    /* ===== STEP 2: CONSOLIDATED DESIGN TOKENS ===== */
    
    /* Theme Colors - Primary Palette */
    --bg-form-neutral: #C1C3C7;
    --bg-form-orden: #0E79B2;
    --bg-form-caos: #E4572E;
    --bg-color-1: #E5E7EB;
    --bg-color-2: #191716;
    --bg-color-3: #F2AF29;
    --bg-color-4: #E63462;
    --bg-color-5: #9E2A2B;
    --bg-color-6: #DD8E2A;
    --bg-color-7: #31E981;
    --bg-color-8: #388697;
    --bg-color-9: #7F5A83;
    
    /* Semantic Color Mappings */
    --primary: var(--bg-color-3);
    --primary-rgb: 242, 175, 41;
    --danger: var(--bg-color-4);
    --danger-rgb: 230, 52, 98;
    --success: var(--bg-color-7);
    --success-rgb: 49, 233, 129;
    --required-color: var(--bg-color-4);
    --bg-color-btn-dice: var(--bg-color-3);
    --bg-title: var(--bg-color-3);
    --bg-loader: var(--bg-color-3);

    /* Typography System */
    --font-size-xs: 0.75rem;    /* 12px */
    --font-size-sm: 0.875rem;   /* 14px */
    --font-size-base: 1rem;     /* 16px */
    --font-size-lg: 1.125rem;   /* 18px */
    --font-size-xl: 1.25rem;    /* 20px */
    --font-size-2xl: 1.5rem;    /* 24px */
    --font-size-3xl: 1.875rem;  /* 30px */
    
    --line-height-tight: 1.25;
    --line-height-normal: 1.5;
    --line-height-relaxed: 1.75;
    
    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;
    --font-weight-black: 900;
    
    /* Spacing System */
    --spacing-xs: 0.25rem;    /* 4px */
    --spacing-sm: 0.5rem;     /* 8px */
    --spacing-md: 0.75rem;    /* 12px */
    --spacing-lg: 1rem;       /* 16px */
    --spacing-xl: 1.25rem;    /* 20px */
    --spacing-2xl: 1.5rem;    /* 24px */
    --spacing-3xl: 2rem;      /* 32px */
    --spacing-4xl: 2.5rem;    /* 40px */
    
    /* Grid System */
    --grid-gap-tight: 0.5rem;
    --grid-gap-normal: 0.75rem;
    --grid-gap-relaxed: 1rem;
    --grid-gap-loose: 1.25rem;
    
    /* Form Element Sizing */
    --form-height-sm: 2.5rem;
    --form-height-md: 3rem;
    --form-height-lg: 3.5rem;
    
    /* Border Radius System (consolidated - removed duplicates) */
    --border-radius-sm: 0.375rem;
    --border-radius-md: 0.5rem;
    --border-radius-lg: 0.75rem;
    --border-radius-xl: 1rem;
    --border-card: 0.5rem; /* Legacy support */
    
    /* Border Colors */
    --border-light: #e5e7eb;
    --border-medium: #d1d5db;
    --border-dark: #9ca3af;
    
    /* Text Colors (consolidated - removed duplicates) */
    --text-primary: #1f2937;
    --text-secondary: #374151;
    --text-muted: #6b7280;
    
    /* Background Colors */
    --bg-grey-lighter: #f9fafb;
    --bg-main: #f8fafc;
    
    /* Shadow System */
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    
    /* Focus Ring System */
    --focus-ring: 0 0 0 3px rgba(242, 175, 41, 0.1);
    --focus-ring-orden: 0 0 0 3px rgba(14, 121, 178, 0.1);
    --focus-ring-caos: 0 0 0 3px rgba(228, 87, 46, 0.1);
    
    /* Transition System (consolidated) */
    --transition-fast: all 0.15s ease;
    --transition-normal: all 0.2s ease;
    --transition-standard: 0.2s; /* Alias for compatibility */
    --transition-slow: all 0.3s ease;
    
    /* Legacy Support */
    --un-border-opacity: 1;
}

body{
    scrollbar-color: var(--bg-color-3) var(--bg-color-1) ;
    scrollbar-width: thin;
}

/* Focus state utilities */
.focus-ring {
    &:focus {
        border-color: var(--bg-color-3);
        box-shadow: var(--current-focus-ring);
        outline: none;
    }
}

.focus-ring-orden {
    &:focus {
        border-color: var(--bg-form-orden);
        box-shadow: var(--focus-ring-orden);
        outline: none;
    }
}

.focus-ring-caos {
    &:focus {
        border-color: var(--bg-form-caos);
        box-shadow: var(--focus-ring-caos);
        outline: none;
    }
}

/* =====================================================
   STEP 3: ENHANCED GRID SYSTEM - FORM SHEET LAYOUT
   ===================================================== */

.form-sheet {
    display: grid;
    min-height: 100vh;
    width: 100%;
    max-width: 100vw;
    margin: 0 auto;
    position: relative;
    overflow-x: hidden;
    
    /* ===== MOBILE-FIRST GRID LAYOUT ===== */
    /* Mobile (≤767px): Single column stack */
    grid-template-columns: 1fr;
    grid-template-rows: repeat(6, auto);
    grid-template-areas:
        "title"
        "info"
        "stats"
        "armament"
        "skills"
        "inventory";
    padding: var(--spacing-md);
    gap: var(--spacing-lg);
    
    /* ===== RESPONSIVE BREAKPOINTS ===== */
    /* Tablet (768px - 1023px): Two column layout */
    @media (min-width: 768px) {
        grid-template-columns: repeat(8, 1fr);
        grid-template-rows: auto auto auto auto;
        grid-template-areas:
            "title title title title title title title title"
            "info info info info info info info info"
            "stats stats stats stats armament armament armament armament"
            "skills skills skills skills inventory inventory inventory inventory";
        padding: var(--spacing-lg);
        gap: var(--spacing-xl);
        max-width: 1200px;
    }
      /* Desktop (1024px - 1599px): Optimized three column layout */
    @media (min-width: 1024px) {
        grid-template-columns: repeat(12, 1fr);
        grid-template-rows: auto auto auto auto auto;
        grid-template-areas:
            "title title title title title title title title title title title title"
            "info info info info info info info info info info info info"
            "stats stats stats stats armament armament armament armament . . . ."
            "stats stats stats stats skills skills skills skills . . . ."
            ". . . . inventory inventory inventory inventory inventory inventory inventory inventory";
        max-width: 1400px;
    }
      /* Large Desktop (≥1600px): Full wide layout */
    @media (min-width: 1600px) {
        grid-template-columns: repeat(16, 1fr);
        grid-template-rows: auto auto auto auto auto;
        grid-template-areas:
            "title title title title title title title title title title title title title title title title"
            "info info info info info info info info info info info info info info info info"
            "stats stats stats stats armament armament armament armament . . . . . . . ."
            "stats stats stats stats skills skills skills skills . . . . . . . ."
            ". . . . inventory inventory inventory inventory inventory inventory inventory inventory inventory inventory inventory inventory";
        max-width: 1800px;
    }
    
    /* ===== BACKGROUND AND THEMING ===== */
    background: linear-gradient(135deg, var(--bg-main) 0%, color-mix(in srgb, var(--bg-main) 95%, white) 100%);
    
    /* Pattern overlay for visual texture */
    &::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-size: var(--spacing-3xl) var(--spacing-3xl);
        opacity: 0.03;
        pointer-events: none;
        z-index: 0;
    }
    
    /* Ensure content appears above pattern */
    > * {
        position: relative;
        z-index: 1;
    }
    
    /* Enhanced alignment-specific styling */
    &.orden {
        background: linear-gradient(135deg, var(--bg-form-orden) 0%, color-mix(in srgb, var(--bg-form-orden) 95%, white) 100%);
        --bg-color-btn-dice: var(--bg-form-orden);
        --required-color: var(--bg-form-orden);
        --bg-title: var(--bg-form-orden);
        --bg-loader: var(--bg-form-orden);
        --current-focus-ring: var(--focus-ring-orden);
        
        /* Order-specific pattern */
        &::before {
            background-image: linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%), 
                            linear-gradient(-45deg, rgba(255,255,255,0.1) 25%, transparent 25%), 
                            linear-gradient(45deg, transparent 75%, rgba(255,255,255,0.1) 75%), 
                            linear-gradient(-45deg, transparent 75%, rgba(255,255,255,0.1) 75%);
        }
    }
    
    &.caos {
        background: linear-gradient(135deg, var(--bg-form-caos) 0%, color-mix(in srgb, var(--bg-form-caos) 95%, white) 100%);
        --bg-color-btn-dice: var(--bg-form-caos);
        --required-color: var(--bg-form-caos);
        --bg-title: var(--bg-form-caos);
        --bg-loader: var(--bg-form-caos);
        --current-focus-ring: var(--focus-ring-caos);
        /* Chaos-specific pattern */
        &::before {
            background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.2) 1px, transparent 0);
        }
    }
    
    /* ===== GRID AREA ASSIGNMENTS FOR FIELDSETS ===== */
    
    /* Form Title Section */
    .fieldset-form.form-title {
        grid-area: title;
    }
    
    /* Info Player Section */
    .fieldset-form.info-player {
        grid-area: info;
    }
    
    /* Stats Player Section */
    .fieldset-form.stats-player {
        grid-area: stats;
    }
    
    /* Initial Armament Section */
    .fieldset-form.initial-armament {
        grid-area: armament;
    }
    
    /* Skills Player Section */
    .fieldset-form.skills-player {
        grid-area: skills;
    }
    
    /* Inventory Player Section */
    .fieldset-form.inventory-player {
        grid-area: inventory;
    }
}

/* =====================================================
   ENHANCED FIELDSET ORGANIZATION WITH GRID AREAS
   ===================================================== */

/* Enhanced fieldset base layout */
.fieldset-form {
    display: grid;
    gap: var(--grid-gap-relaxed);
    padding: var(--spacing-2xl);
    margin: 0;
    border: 2px solid color-mix(in srgb, var(--bg-color-3) 20%, transparent);
    border-radius: var(--border-radius-lg);
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(8px);
    transition: all var(--transition-standard) ease;
    
    /* Responsive padding adjustments */
    @media (max-width: 767px) {
        padding: var(--spacing-lg);
    }
    
    @media (min-width: 1024px) {
        padding: var(--spacing-3xl);
    }
    
    /* Hover effect for interactive enhancement */
    &:hover {
        box-shadow: 
            0 12px 48px rgba(0, 0, 0, 0.12),
            0 4px 12px rgba(0, 0, 0, 0.06),
            inset 0 1px 0 rgba(255, 255, 255, 0.95);
        transform: translateY(-2px);
    }
    
    /* Legend styling with enhanced typography */
    legend {
        font-size: var(--font-size-lg);
        font-weight: var(--font-weight-bold);
        color: var(--text-primary);
        padding: var(--spacing-sm) var(--spacing-xl);
        background: linear-gradient(135deg, var(--bg-color-3) 0%, color-mix(in srgb, var(--bg-color-3) 85%, white) 100%);
        border: 2px solid color-mix(in srgb, var(--bg-color-3) 30%, transparent);
        border-radius: var(--border-radius-md);
        margin-bottom: var(--spacing-lg);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        letter-spacing: 0.5px;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        
        /* Icon alignment */
        svg {
            vertical-align: middle;
            margin-right: var(--spacing-sm);
        }
    }
}

/* =====================================================
   SPECIFIC FIELDSET CONFIGURATIONS
   ===================================================== */

/* 1. Form Title Section */
.fieldset-form.form-title {
    grid-area: title;
    grid-template-columns: 1fr;
    min-height: auto;
    text-align: center;
    
    h1 {
        font-size: var(--font-size-2xl);
        font-weight: var(--font-weight-black);
        margin: 0;
        color: var(--text-primary);
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
}

/* 2. Info Player Section */
.fieldset-form.info-player {
    grid-area: info;
    grid-template-columns: repeat(8, 1fr);
    grid-template-rows: repeat(10, auto);
    
    /* Visual separation between left and right columns */
    &::after {
        content: '';
        position: absolute;
        top: 3rem;
        left: 62.5%;
        bottom: 2rem;
        width: 1px;
        background: linear-gradient(180deg, 
            transparent 0%, 
            color-mix(in srgb, var(--border-light) 60%, transparent) 20%, 
            color-mix(in srgb, var(--border-light) 60%, transparent) 80%, 
            transparent 100%);
        z-index: 1;
        pointer-events: none;
    }
    
    @media (max-width: 767px) {
        grid-template-columns: 1fr;
        grid-template-rows: auto;
        
        &::after {
            display: none;
        }
    }
}

/* 3. Stats Player Section */
.fieldset-form.stats-player {
    grid-area: stats;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: auto repeat(6, 1fr);
    
    .stats-player-header {
        grid-column: 1 / -1;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--spacing-md);
        background: color-mix(in srgb, var(--bg-color-2) 15%, transparent);
        border-radius: var(--border-radius-md);
        margin-bottom: var(--spacing-lg);
    }
}

/* 4. Initial Armament Section */
.fieldset-form.initial-armament {
    grid-area: armament;
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: repeat(6, auto);
}

/* 5. Skills Player Section */
.fieldset-form.skills-player {
    grid-area: skills;
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: repeat(8, auto);
}

/* 6. Inventory Player Section */
.fieldset-form.inventory-player {
    grid-area: inventory;
    grid-template-columns: 1fr;
    grid-template-rows: auto 1fr auto;
}

/* =====================================================
   ENHANCED FORM ELEMENTS AND COMPONENTS
   ===================================================== */

/* Form input and label base styles */
.form-lbl, .form-lbl-y {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--text-secondary);
    padding: var(--spacing-sm) var(--spacing-md);
    border: 2px solid var(--border-light);
    background-color: var(--bg-grey-lighter);
    border-radius: var(--border-radius-sm);
    display: flex;
    align-items: center;
    justify-content: flex-start;
    margin-bottom: var(--spacing-xs);
    transition: all var(--transition-fast);
    min-height: var(--form-height-sm);
    
    &:hover {
        border-color: var(--border-medium);
        background-color: color-mix(in srgb, var(--bg-grey-lighter) 95%, white);
    }
}

.form-input, .form-input-y {
    padding: var(--spacing-sm) var(--spacing-md);
    border: 2px solid var(--border-medium);
    border-radius: var(--border-radius-sm);
    background-color: white;
    color: var(--text-primary);
    font-size: var(--font-size-sm);
    line-height: var(--line-height-normal);
    transition: all var(--transition-fast);
    min-height: var(--form-height-sm);
    
    &:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 
            inset 0 1px 2px rgba(0, 0, 0, 0.05),
            0 0 0 3px rgba(var(--primary-rgb), 0.1),
            0 2px 4px rgba(0, 0, 0, 0.1);
        background-color: #fefefe;
    }
    
    &:read-only {
        background-color: var(--bg-grey-lighter);
        border-style: dashed;
        color: var(--text-muted);
        cursor: not-allowed;
    }
}

/* Numeric input styling */
.numeric-input {
    text-align: center;
    font-weight: var(--font-weight-semibold);
    font-size: var(--font-size-base);
    background-color: color-mix(in srgb, var(--primary) 3%, white);
    
    /* Remove number input arrows */
    &::-webkit-outer-spin-button,
    &::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }
    
    &[type=number] {
        appearance: textfield;
        -moz-appearance: textfield;
    }
}

/* Enhanced textarea styling */
textarea.form-input-y {
    resize: vertical;
    min-height: 4rem;
    line-height: var(--line-height-relaxed);
    
    &:focus {
        min-height: 6rem;
    }
    
    @media (max-width: 767px) {
        min-height: 6rem;
    }
}

/* Grid positioning utilities for fine-tuning */
.col-start-1 { grid-column-start: 1; }
.col-start-2 { grid-column-start: 2; }
.col-start-3 { grid-column-start: 3; }
.col-start-4 { grid-column-start: 4; }
.col-start-5 { grid-column-start: 5; }
.col-start-6 { grid-column-start: 6; }
.col-start-7 { grid-column-start: 7; }
.col-start-8 { grid-column-start: 8; }
.col-start-9 { grid-column-start: 9; }
.col-start-10 { grid-column-start: 10; }
.col-start-11 { grid-column-start: 11; }
.col-start-12 { grid-column-start: 12; }

.col-end-1 { grid-column-end: 1; }
.col-end-2 { grid-column-end: 2; }
.col-end-3 { grid-column-end: 3; }
.col-end-4 { grid-column-end: 4; }
.col-end-5 { grid-column-end: 5; }
.col-end-6 { grid-column-end: 6; }
.col-end-7 { grid-column-end: 7; }
.col-end-8 { grid-column-end: 8; }
.col-end-9 { grid-column-end: 9; }
.col-end-10 { grid-column-end: 10; }
.col-end-11 { grid-column-end: 11; }
.col-end-12 { grid-column-end: 12; }
.col-end-13 { grid-column-end: 13; }

.row-start-1 { grid-row-start: 1; }
.row-start-2 { grid-row-start: 2; }
.row-start-3 { grid-row-start: 3; }
.row-start-4 { grid-row-start: 4; }
.row-start-5 { grid-row-start: 5; }
.row-start-6 { grid-row-start: 6; }
.row-start-7 { grid-row-start: 7; }
.row-start-8 { grid-row-start: 8; }
.row-start-9 { grid-row-start: 9; }
.row-start-10 { grid-row-start: 10; }
.row-start-11 { grid-row-start: 11; }
.row-start-12 { grid-row-start: 12; }

.row-span-1 { grid-row: span 1 / span 1; }
.row-span-2 { grid-row: span 2 / span 2; }
.row-span-3 { grid-row: span 3 / span 3; }
.row-span-4 { grid-row: span 4 / span 4; }
.row-span-5 { grid-row: span 5 / span 5; }
.row-span-6 { grid-row: span 6 / span 6; }

.col-span-1 { grid-column: span 1 / span 1; }
.col-span-2 { grid-column: span 2 / span 2; }
.col-span-3 { grid-column: span 3 / span 3; }
.col-span-4 { grid-column: span 4 / span 4; }
.col-span-5 { grid-column: span 5 / span 5; }
.col-span-6 { grid-column: span 6 / span 6; }
.col-span-7 { grid-column: span 7 / span 7; }
.col-span-8 { grid-column: span 8 / span 8; }

/* Enhanced grid gap utilities */
.gap-none { gap: 0; }
.gap-xs { gap: var(--spacing-xs); }
.gap-sm { gap: var(--spacing-sm); }
.gap-md { gap: var(--spacing-md); }
.gap-lg { gap: var(--spacing-lg); }
.gap-xl { gap: var(--spacing-xl); }
.gap-2xl { gap: var(--spacing-2xl); }

/* Grid auto-fit utilities for responsive layouts */
.grid-auto-fit-xs { grid-template-columns: repeat(auto-fit, minmax(8rem, 1fr)); }
.grid-auto-fit-sm { grid-template-columns: repeat(auto-fit, minmax(12rem, 1fr)); }
.grid-auto-fit-md { grid-template-columns: repeat(auto-fit, minmax(16rem, 1fr)); }
.grid-auto-fit-lg { grid-template-columns: repeat(auto-fit, minmax(20rem, 1fr)); }

/* Grid alignment utilities */
.place-items-center { place-items: center; }
.place-items-start { place-items: start; }
.place-items-end { place-items: end; }
.place-content-center { place-content: center; }
.place-content-start { place-content: start; }
.place-content-end { place-content: end; }

/* =====================================================
   ENHANCED GRID LAYOUT OPTIMIZATION
   ===================================================== */

/* Grid container performance optimization */
.form-sheet {
    /* Improve rendering performance */
    will-change: contents;
    contain: layout style;
    
    /* Enhanced content flow */
    overflow: visible;
    scroll-snap-type: y mandatory;
    
    /* Improved mobile-first approach */
    @media (max-width: 767px) {
        /* Ensure proper stacking on mobile */
        grid-template-rows: auto auto auto auto auto auto;
        scroll-padding-top: var(--spacing-lg);
        
        /* Mobile scroll snap points */
        .fieldset-form {
            scroll-snap-align: start;
            scroll-margin-top: var(--spacing-lg);
        }
    }
    /* Enhanced tablet optimization */
    @media (min-width: 768px) and (max-width: 1023px) {
        /* More balanced tablet grid */
        grid-template-columns: repeat(8, minmax(0, 1fr));
        grid-template-areas:
            "title title title title title title title title"
            "info info info info info info info info"
            "stats stats stats stats armament armament armament armament"
            "skills skills skills skills inventory inventory inventory inventory";
        
        /* Better content distribution */
        .fieldset-form.stats-player,
        .fieldset-form.initial-armament {
            min-height: 350px;
        }
        
        .fieldset-form.skills-player,
        .fieldset-form.inventory-player {
            min-height: 400px;
        }
    }
    /* Enhanced desktop layout */
    @media (min-width: 1024px) and (max-width: 1599px) {
        grid-template-columns: repeat(8, minmax(0, 1fr));
        grid-template-areas:
            "title title title title title title title title"
            "info info info info info info info info"
            "stats stats stats stats armament armament armament armament"
            "skills skills skills skills inventory inventory inventory inventory";
        
        /* Optimized fieldset heights for desktop */
        .fieldset-form.stats-player {
            min-height: 400px;
        }
        
        .fieldset-form.initial-armament {
            min-height: 400px;
        }
        
        .fieldset-form.skills-player {
            min-height: 450px;
        }
        
        .fieldset-form.inventory-player {
            min-height: 500px;
        }
    }
    
    /* Ultra-wide optimizations */
    @media (min-width: 1600px) {
        grid-template-columns: repeat(8, minmax(0, 1fr));
        grid-template-areas:
            "title title title title title title title title"
            "info info info info info info info info"
            "stats stats stats stats armament armament armament armament"
            "skills skills skills skills inventory inventory inventory inventory";
        
        /* Maximum content optimization */
        .fieldset-form.stats-player,
        .fieldset-form.initial-armament,
        .fieldset-form.skills-player {
            min-height: 500px;
        }
        
        .fieldset-form.inventory-player {
            min-height: 600px;
        }
    }
}

/* =====================================================
   ENHANCED FIELDSET GRID CONFIGURATIONS
   ===================================================== */

/* 1. Form Title Section - Enhanced */
.fieldset-form.form-title {
    /* Improved layout */
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: auto;
    
    /* Better responsive behavior */
    @media (max-width: 767px) {
        padding: var(--spacing-lg);
    }
    
    @media (min-width: 768px) {
        padding: var(--spacing-xl);
    }
    
    @media (min-width: 1024px) {
        padding: var(--spacing-2xl);
    }
}

/* 2. Info Player Section - Enhanced */
.fieldset-form.info-player {
    /* Mobile-first grid */
    grid-template-columns: 1fr;
    grid-template-rows: repeat(auto-fit, minmax(3rem, auto));
    
    @media (min-width: 768px) {
        grid-template-columns: repeat(6, 1fr);
        grid-template-rows: repeat(10, minmax(3rem, auto));
    }
    
    @media (min-width: 1024px) {
        grid-template-columns: repeat(8, 1fr);
        grid-template-rows: repeat(10, minmax(3.5rem, auto));
    }
    
    @media (min-width: 1600px) {
        grid-template-columns: repeat(10, 1fr);
        grid-template-rows: repeat(10, minmax(4rem, auto));
    }
    
    /* Enhanced visual separation */
    &::after {
        @media (min-width: 768px) {
            content: '';
            position: absolute;
            top: 3rem;
            left: 62.5%;
            bottom: 2rem;
            width: 1px;
            background: linear-gradient(180deg, 
                transparent 0%, 
                color-mix(in srgb, var(--border-light) 60%, transparent) 20%, 
                color-mix(in srgb, var(--border-light) 60%, transparent) 80%, 
                transparent 100%);
            z-index: 1;
            pointer-events: none;
        }
        
        @media (max-width: 767px) {
            display: none;
        }
    }
}

/* 3. Stats Player Section - Enhanced */
.fieldset-form.stats-player {
    /* Responsive grid configuration */
    @media (max-width: 767px) {
        grid-template-columns: 1fr;
        grid-template-rows: auto repeat(6, minmax(4rem, auto));
    }
    
    @media (min-width: 768px) and (max-width: 1023px) {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: auto repeat(3, minmax(4rem, 1fr));
    }
    
    @media (min-width: 1024px) and (max-width: 1599px) {
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: auto repeat(2, minmax(4rem, 1fr));
    }
    
    @media (min-width: 1600px) {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: auto repeat(3, minmax(4rem, 1fr));
    }
    
    .stats-player-header {
        grid-column: 1 / -1;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--spacing-md);
        background: color-mix(in srgb, var(--bg-color-2) 15%, transparent);
        border-radius: var(--border-radius-md);
        margin-bottom: var(--spacing-lg);
    }
}

/* 4. Initial Armament Section - Enhanced */
.fieldset-form.initial-armament {
    /* Responsive grid layout */
    @media (max-width: 767px) {
        grid-template-columns: 1fr;
        grid-template-rows: repeat(6, auto);
    }
    
    @media (min-width: 768px) {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(6, auto);
    }
    
    /* Better content organization */
    .weapon-section {
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--spacing-md);
    }
    
    .skills-section {
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--spacing-md);
        margin-top: var(--spacing-lg);
    }
}

/* 5. Skills Player Section - Enhanced */
.fieldset-form.skills-player {
    /* Responsive skill layout */
    @media (max-width: 767px) {
        grid-template-columns: 1fr;
        grid-template-rows: repeat(8, auto);
    }
    
    @media (min-width: 768px) and (max-width: 1023px) {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(6, auto);
    }
    
    @media (min-width: 1024px) and (max-width: 1599px) {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(4, auto);
    }
    
    @media (min-width: 1600px) {
        grid-template-columns: repeat(4, 1fr);
        grid-template-rows: repeat(4, auto);
    }
}

/* 6. Inventory Player Section - Enhanced */
.fieldset-form.inventory-player {
    /* Responsive inventory layout */
    grid-template-columns: 1fr;
    grid-template-rows: auto 1fr auto;
    
    @media (min-width: 768px) {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: auto 1fr auto;
    }
    
    @media (min-width: 1024px) {
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: auto 1fr auto;
    }
    
    @media (min-width: 1600px) {
        grid-template-columns: repeat(4, 1fr);
        grid-template-rows: auto 1fr auto;
    }
}

/* =====================================================
   GRID SYSTEM UTILITIES AND HELPERS
   ===================================================== */

/* Dynamic grid templates for complex layouts */
.grid-dynamic-1 { grid-template-columns: 1fr; }
.grid-dynamic-2 { grid-template-columns: repeat(2, 1fr); }
.grid-dynamic-3 { grid-template-columns: repeat(3, 1fr); }
.grid-dynamic-4 { grid-template-columns: repeat(4, 1fr); }
.grid-dynamic-6 { grid-template-columns: repeat(6, 1fr); }
.grid-dynamic-8 { grid-template-columns: repeat(8, 1fr); }
.grid-dynamic-12 { grid-template-columns: repeat(12, 1fr); }

/* Responsive grid modifiers */
@media (min-width: 768px) {
    .md\:grid-dynamic-2 { grid-template-columns: repeat(2, 1fr); }
    .md\:grid-dynamic-3 { grid-template-columns: repeat(3, 1fr); }
    .md\:grid-dynamic-4 { grid-template-columns: repeat(4, 1fr); }
    .md\:grid-dynamic-6 { grid-template-columns: repeat(6, 1fr); }
    .md\:grid-dynamic-8 { grid-template-columns: repeat(8, 1fr); }
}

@media (min-width: 1024px) {
    .lg\:grid-dynamic-3 { grid-template-columns: repeat(3, 1fr); }
    .lg\:grid-dynamic-4 { grid-template-columns: repeat(4, 1fr); }
    .lg\:grid-dynamic-6 { grid-template-columns: repeat(6, 1fr); }
    .lg\:grid-dynamic-8 { grid-template-columns: repeat(8, 1fr); }
    .lg\:grid-dynamic-12 { grid-template-columns: repeat(12, 1fr); }
}

/* Grid flow utilities */
.grid-flow-row { grid-auto-flow: row; }
.grid-flow-col { grid-auto-flow: column; }
.grid-flow-dense { grid-auto-flow: row dense; }

/* Advanced positioning utilities */
.justify-self-auto { justify-self: auto; }
.justify-self-start { justify-self: start; }
.justify-self-end { justify-self: end; }
.justify-self-center { justify-self: center; }
.justify-self-stretch { justify-self: stretch; }

.align-self-auto { align-self: auto; }
.align-self-start { align-self: start; }
.align-self-end { align-self: end; }
.align-self-center { align-self: center; }
.align-self-stretch { align-self: stretch; }

/* =====================================================
   GRID PERFORMANCE AND OPTIMIZATION ENHANCEMENTS
   ===================================================== */

/* Container queries for advanced responsive behavior */
@container (min-width: 600px) {
    .fieldset-form.info-player {
        grid-template-columns: repeat(4, 1fr);
    }
}

@container (min-width: 800px) {
    .fieldset-form.stats-player {
        grid-template-columns: repeat(3, 1fr);
    }
}

/* CSS Subgrid support for future enhancement */
@supports (grid-template-rows: subgrid) {
    .fieldset-form {
        display: grid;
        grid-template-rows: subgrid;
    }
}

/* Grid layout debugging utilities (development only) */
.debug-grid {
    position: relative;
    
    &::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            linear-gradient(to right, rgba(255, 0, 0, 0.1) 1px, transparent 1px),
            linear-gradient(to bottom, rgba(255, 0, 0, 0.1) 1px, transparent 1px);
        background-size: 
            calc(100% / var(--grid-columns, 12)) 
            calc(100% / var(--grid-rows, 12));
        pointer-events: none;
        z-index: 9999;
    }
    
    .fieldset-form {
        border: 1px dashed rgba(0, 255, 0, 0.5);
        position: relative;
        
        &::after {
            content: attr(class);
            position: absolute;
            top: 0;
            left: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 2px 4px;
            font-size: 10px;
            z-index: 10000;
        }
    }
}

/* Layout shift prevention */
.form-sheet {
    /* Prevent cumulative layout shift */
    content-visibility: auto;
    contain-intrinsic-size: 100vh;
}

.fieldset-form {
    /* Minimize reflows during dynamic content loading */
    contain: layout style;
    
    /* Optimize for animations */
    &:has(.loading) {
        contain: layout style paint;
    }
}

/* =====================================================
   ACCESSIBILITY AND USER EXPERIENCE IMPROVEMENTS
   ===================================================== */

/* Focus management for grid navigation */
.form-sheet {
    /* Ensure logical focus order */
    &:focus-within {
        scroll-behavior: smooth;
    }
}

.fieldset-form {
    /* Screen reader navigation support */
    &[aria-expanded="false"] {
        max-height: 4rem;
        overflow: hidden;
        
        legend::after {
            content: " (minimized)";
            font-size: 0.8em;
            opacity: 0.7;
        }
    }
    
    /* Keyboard navigation enhancement */
    &:focus-within {
        z-index: 10;
        box-shadow: 
            var(--shadow-lg),
            0 0 0 3px rgba(var(--primary-rgb), 0.2);
    }
}

/* High contrast mode optimizations */
@media (prefers-contrast: high) {
    .form-sheet {
        gap: var(--spacing-xl);
    }
    
    .fieldset-form {
        border: 3px solid #000;
        background: #fff;
        
        &:focus-within {
            border-color: #0066cc;
        }
    }
    
    .grid-area-title { background: #000; color: #fff; }
    .grid-area-info { background: #f0f0f0; }
    .grid-area-stats { background: #e0e0e0; }
    .grid-area-armament { background: #d0d0d0; }
    .grid-area-skills { background: #c0c0c0; }
    .grid-area-inventory { background: #b0b0b0; }
}

/* Reduced motion optimizations */
@media (prefers-reduced-motion: reduce) {
    .form-sheet {
        scroll-behavior: auto;
        animation: none;
    }
    
    .fieldset-form {
        transition: none;
        transform: none !important;
    }
    
    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* Print optimizations for grid layout */
@media print {
    .form-sheet {
        display: block !important;
        grid-template-areas: none !important;
        gap: 0 !important;
        padding: 0 !important;
        background: white !important;
    }
    
    .fieldset-form {
        display: block !important;
        grid-template-columns: none !important;
        grid-area: auto !important;
        page-break-inside: avoid;
        margin-bottom: 1rem;
        border: 1px solid #000;
        background: white !important;
    }
    
    .panel-save,
    .debug-grid::before,
    .fieldset-form::after {
        display: none !important;
    }
}

